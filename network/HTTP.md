# HTTP

## 1. 모든것이 HTTP

- HyperText(HTML) Transfer Protocol의 약자.
- 최초에는 HTML을 전달하는 방식이였으나, 모든형태의 데이터를 전달하는 방식으로 확장됨.
- ex.
  - Image,음성,영상,파일,
  - JSON,XML
  - 서버간에 데이터를 주고 받을떄도 대부분 HTTP사용.
    <br></br>

### 1) HTTP 역사

- HTTP/0.9 1991년: GET 메서드만 지원, HTTP 헤더X
- HTTP/1.0 1996년: 메서드, 헤더 추가
- **HTTP/1.1 1997년: 가장 많이 사용, 우리에게 가장 중요한 버전**(중요)
  - 개정판 RFC2068(1997) -> RFC2616(1999) -> RFC7230~7235(2014)
- HTTP/2 2015년: 성능 개선
- HTTP/3 진행중: TCP 대신에 UDP 사용, 성능 개선
  <br></br>

### 2) 기반 프로토콜

- HTTP/1.1, HTTP/2 : TCP
- HTTP/3 : UDP (TCP의 3way - handshake, 많은양의 전송데이터등에의해 속도저하를 발생시킬 수 있는점을 보완)
- 현재 HTTP/1.1 주로 사용
  - HTTP/2, HTTP/3 도 점점 증가

<br></br>
<br></br>

## 2. HTTP 특징

- 클라이언트 <-> 서버 구조로 이루어짐.
- 무상태 프로토콜(스테이스리스), 비연결성, HTTP 메시지.
- 단순함, 확장 가능.
  <br></br>

### 1) 클라이언트 <-> 서버 구조

- Request Response 구조.
- 클라이언트는 서버에 요청을 보내고, 응답을 대기.
- 서버가 요청에 대한 결과를 만들어서 클라이언트에게 응답.
- 클라이언트에서 응답결과를 통해 동작.

  -> 클라이언트와 서버를 분리하여 생각할것(독립적으로 발전)

  - 서버는 비즈니스로직, 데이터를 관리.
  - 클라이언트는 UI, 사용성을 관리(여러기기에대한 반응형).
    <br></br>

### 2-1) 무상태 프로토콜(stateless)을 지향한다.

- 서버가 클라이언트의 이전상태를 보존하지않는다.
- 장점: 서버 확장성 높음(스케일 아웃)
  - ex. 갑자기 트래픽이 급격히 증가해도, 여러서버를 연결하여 확장시킬 수 있다.
  - 중간에 통신중인 서버가 장애가 발생해도, 중계서버에서 다른 서버로 데이터를 전달해줘도 처리할 수 있다(이전 상태를 보존하지 않기 떄문에).
- 단점: 클라이언트가 한번에 전송하는 데이터양이 stateful에비해 많다.
- Stateful vs Stateless 차이
  - Stateful은 클라이언트의 이전상태를 보존한다.
  - Stateful은 통신중 서버에서 장애가 발생하면 클라이언트측에서 정보를 처음부터 다시보내야한다.
  - Stateful은 급격히 증가되는 트래픽에대해 대응이 어렵다.
- 실무적 한계
  - 모든 것을 무상태로 설계 할 수 있는 경우도 있고 없는 경우도 있다.
  - ex.
    - 로그인이 필요없는 단순 서비스 소개 페이지. (상태유지 필요x)
    - 로그인. (상태유지 필요)
      - 로그인한 사용자의 경우 로그인을 했다는 상태를 서버에 유지.
      - 일반적으로 브라우저의 쿠키와 서버의 세션을 이용하여 상태를 유지시킴.
  - 상태유지는 최소한으로 사용해야한다.

### 2-2) 비 연결성(connectionless)

- TCP/IP는 기본적으로 연결상태를 유지한다.
  - 클라이언트1과 통신후 클라이언트2와 통신할떄에도, 클라이언트1과의 연결이 유지됨으로써 서버자원이 사용되고있다.
  - 연결을 유지시키지 않음으로써(비연결성) 사용되는 서버자원을 줄일 수 있다.
- HTTP는 기본적으로 연결을 유지하지않는 모델이다.
- 일반적으로 초 단위 이하의 빠른 속도로 응답을함.
- 1시간 동안 수천명이 서비스를 사용해도 실제 서버에서 동시에 처리하는 요청은 수십개 이 하로 매우 작음.
  - 웹 브라우저에서 모든 클라이언트가 연속해서 검색 버튼을 누르지 않는다.
- 서버자원을 효율적으로 사용 할 수 있게된다.

#### 비연결성의 한계

- 통신을 할떄마다 TCP/IP연결을 새로 맺어야함으로 3way handshake 시간이 추가된다.
- 웹 브라우저로 사이트를 요청하면 HTML 뿐만 아니라 자바스크립트, css, 추가 이미지 등
  등 수 많은 자원이 함께 다운로드(각 데이터를 받을떄마다 새로맺는건 비효율적이다.)
- HTTP 지속 연결(Persistent Connections)로 문제 해결 (내부 메커니즘에의해 연결시간정의)
- HTTP/2, HTTP/3에서 더 많은 최적화.

#### stateless가 중요하다.

서버 개발자들이 어려워하는 업무.

- 정확하게 동일한 시간에 발생하는 대용량 트래픽
  - ex. 선착순 이벤트, 학과 수강신청등
  - 비연결성이 의미가 없어짐.
  - stateless로 구성하여 서버확장을통해 대응할 수 있다.
- 최대한 stateless로 구성하려 노력할것.
  <br></br>

### 2-3) HTTP 메세지

 <img width="497" alt="스크린샷 2022-01-09 오후 2 25 29" src="https://user-images.githubusercontent.com/58588011/148670535-5acdd485-5fec-4262-a9ef-c2f956f62b36.png">

<img width="497" alt="스크린샷 2022-01-09 오후 2 28 01" src="https://user-images.githubusercontent.com/58588011/148670572-9902fb2b-5e22-4ef3-99d3-1341e2476432.png">

#### 1. start-line

- 요청 메세지
  - request-line
    - method 공백 request-target 공백 HTTP-version 로 구성
      - method 종류 : GET,POST,PUT,DELETE등 서버가 수행해야할 동작 지정
      - request-target : 절대경로('/'로 시작하는 경로) + [?쿼리]
      - HTT Version
- 응답 메세지
  - status-line
    - HTTP-version 공백 status-code 공백 reason-phrase 로 구성
      - HTTP Version
      - status-code
        - 200 : 성공
        - 400 : 클라이언트 요청 오류
        - 500 : 500 서버 내부 오류
      - reason-phrase : OK(200 상태코드 보충 설명)

#### 2. Header

- field-name":" OWS field-value OWS (OWS : 띄어쓰기 허용)로 구성

  - field-name은 대소문자 구분 없음.

- Header 용도
  - HTTP 전송에 필요한 모든 부가정보 내포.
    - 메세지 바디의 정보,메세지 바디의 크기, 압축여부, 요청 클라이언트(브라우저)정보, 서버 애플리케이션 정보, 캐시관리정보 ...
  - 표준 헤더가 너무 많음 (이후 강의에서 설명예정)
  - 필요시 임의의 헤더 추가 가능
    - ex. helloworld: hihi (클라이언트와 약속되어있는경우에만)

#### 3. Body

- 실제 전송할 데이터.
- HTML문서,이미지,영상,JOSN등등 byte로 표현 할 수 있는 모든 데이터 전송 가능.

