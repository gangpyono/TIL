# HTTP 상태코드

클라이언트가 보낸 요청의 처리 상태를 응답에서 알려주는 기능

- 1xx (Informational): 요청이 수신되어 처리중. (거의 사용 x)
- 2xx (Successful): 요청 정상 처리.
- 3xx (Redirection): 요청을 완료하려면 추가 행동이 필요.
- 4xx (Client Error): 클라이언트 오류, 잘못된 문법등으로 서버가 요청을 수행할 수 없음.
- 5xx (Server Error): 서버 오류, 서버가 정상 요청을 처리하지 못함.

## 2xx (Successful)

클라이언트의 요청을 성공적으로 처리.

## 3xx (Redirection)

요청을 완료하기 위해 웹브라우저의 추가 조치 필요.

- 300 Multiple Choices : 생략
- 301 Moved Permanently
- 302 Found
- 303 See Other
- 304 Not Modified
- 307 Temporary Redirect
- 308 Permanent Redirect

### 리다이렉션이란.

- 웹 브라우저는 3xx 응답의 결과에 Location 헤더가 있으면, Location 위치로 자동 이동(리다이렉트)
- 자동 리다이렉트 흐름.
  - 바뀌기전의 URI를 북마크해둔 유저가 접속했을시, 최신의 URI로 리다이렉트시킴.

#### 1) 영구 리다이렉션 (실무에서 잘 사용하지 않는다.)

- URI가 영구적으로 이동.
  - 기존의 URI를 사용X, 검색 엔진 등 시스템 상에서 변경 인지.
- 301 : 리다이렉트시 요청 메서드가 GET으로 변하고, 본문이 제거될 수 있음.(MAY)
- 308 : 리다이렉트시 요청 메서드와 본문 유지(처음 POST를 보내면 리다이렉트도 POST 유지) / 301과 기능은 같다.

#### 2) 일시적인 리다리렉션 (실무)

- URI가 일시적으로 변경.
  - 검색 엔진 등 시스템 상에서 기존의 URI를 변경하면 안 됨을 인지시킴.
- 302 : 리다이렉트시 요청 메서드가 GET으로 변하고, 본문이 제거될 수 있음.(MAY)
- 307 : 리다이렉트시 기존 요청 메서드와 본문 유지. / 302와 기능은 같다.
- 303 : 리다이렉트시 요청 메서드가 GET으로 변경되고 본문이 제거됨(명확함). / 302와 기능은 같다.

- 자주사용하는 패턴 : PRG( Post/Redirect/Get )
  - POST로 주문후에 주문 결과 화면을 GET 메서드로 리다이렉트.
  - 307,303을 권장하지만, 이미 많은 애플리케이션에서 302를 기본값으로 사용.
  - 장점
    - POST로 주문후에 새로고침으로 인한 중복 주문 방지.
- Q&A : 302응답을 받기전에 새로고침을 할 경우엔 중복 주문을 막을 수없지않나?
  - 맞다. 그래서 서버에서도 중복 요청시 해결방안을 마련해야함.

-> 영구 리다이렉션 vs 일시적인 리다이렉션 : 단순히 클라이언트에서 처리하는 과정만 보면 동일하다.

#### 3) 기타 리다리렉션

- 304
  - 결과(요청 데이터에대한) 대신 캐시의 내용을 활용하라는 응답메세지를 전달해줌.
  - 클라이언트에게 리소스가 수정되지 않았음을 알려준다. 따라서 클라이언트는 로컬PC에
    저장된 캐시를 재사용한다. (캐시로 리다이렉트 한다.)
  - 응답에 메세지 바디를 포함하면 안된다. (로컬 캐시를 사용해야 하므로)
  - 조건부 GET, HEAD요청시 사용.

## 4xx (Client Error)
클라언트 오류

- 오류의 원인이 클라이언트에 있음.
  - ex. 요청 파라미터가  잘못되거나, API스펙이 맞지 않을떄.


### 401 Unauthorized
클라이언트가 해당 리소스에 대한 인증이 필요함.

- 인증(Authentication)되지않음.
- 401 오류 발생시 응답에 WWW-Authenticate 헤더와 함꼐 인증 방법을 설명 해줄 수 있음.
- 참고 
   - 인증(Authentication) : 본인이 누구인지 확인, (로그인)
   - 인가(Authorization) : 권한부여 (ADMIN 권한처럼 특정 리소스에 접근할 수 있는 권한, 인증이 있어야 인가가 있음)
   - 오류 메시지가 Unauthorized 이지만 인증 되지 않음을 의미함.(이름이 아쉽다.)

### 403 Forbidden
서버가 요청을 이해했지만 승인을 거부함.
- 접근 권한이 불충분한경우.
   - 어드민 등급이 아닌 사용자가 로그인은 했지만, 어드민 등급의 리소스에 접근한경우.

### 404 Not Found
요청 리소스를 찾을 수 없음.
- 요청 리소스가 서버에 없음.

## 5xx(Server Error)
서버 오류

- 서버 문제로 오류 발생.
- 서버에 문제가 있기 떄문에 재시도 하면 성공 할 수도 있음(복구가 되거나 등등)
- 진짜로 서버에 문제가 발생한 경우 사용할 것.
  - ex. 어떤 구매요청이 왔을떄 고객의 잔고가부족한 경우를 5xx로 처리하지말것.

### 500 Internal Server Error
서버 문제로 오류 발생, 애매하면 500오류.


### 503 Service Unavailable
서비스 이용 불가.
- 서버가 일시적인 과부화 또는 예정된 작업으로 잠시 요청을 처리할 수 없는상태.
- Retry-After 헤더 필드로 얼마뒤에 복구되는지 보낼 수도 있음.
- 보통 예측 불가능한 상황(ex.폭주로 서버다운)이 많아 500에러로 처리하는 경우가 많다.


